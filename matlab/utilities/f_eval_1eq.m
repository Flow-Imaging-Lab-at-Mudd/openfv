function [f,df_dr1] = f_eval_1eq(r1,r2,z1,z2,n1,n2)

f      = (r1)./sqrt(r1.^2 + z1.^2) - (n2/n1)*(r2-r1)./sqrt((r2-r1).^2 + z2.^2);

df_dr1 = 1./sqrt(r1.^2 + z1.^2) - r1.^2./(r1.^2 + z1.^2).^(3/2) + (n2/n1)./sqrt(z2.^2 + (r1-r2).^2)...
    - (n2/n1).*(r1-r2).*(2*r1-2*r2)./(2*((r1-r2).^2 + z2.^2).^(3/2));


end

